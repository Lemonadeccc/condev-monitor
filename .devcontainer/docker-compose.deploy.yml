include:
    - docker-compose.yml

services:
    # 应用部署相关
    condev-monitor-server:
        image: node:22-alpine
        container_name: condev-monitor-server
        ports:
            - 8081:8081
        volumes:
            - ../:/app/monitor
        environment:
            - NODE_ENV=production
        working_dir: /app/monitor/apps/backend/monitor
        command: 'node dist/src/main.js'
        depends_on:
            - condev-monitor-postgres
            - condev-monitor-clickhouse
    # condev-monitor-caddy:
    #     image: caddy:latest
    #     container_name: condev-monitor-caddy
    #     ports:
    #         - 80:80
    #         - 443:443
    #         - 443:443/udp
    #         - 5173:5173
    #     volumes:
    #         - ./caddy:/etc/caddy
    #         # - ../:/app
    #         - ../apps/frontend/monitor/dist:/app/frontend/monitor/dist
    #     # command: ["caddy", "run", "--resume", "--config", "/etc/caddy/Caddyfile"]
